"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[16987],{595669:function(e,a,t){t.d(a,{V:function(){return U}});var s=t(247687),i=t(851923),r=t(78271),l=t(273060),n=t(412193),o=t(948668),d=t(289747),c=t(23752),m=t(829025),u=t(820491);const h={type:"mutation",name:"clipRewardPromotionEngine",hash:"a8dc7824835bc1872e6fade3fadc9a95386447db8d8d79ef617abd5e420df4d0"};var x=t(484e3),v=t(969538),w=t(633322);var f=t(324523),C=t.n(f);const g=(e,a,t,s,i)=>C()("pa1 pr3 br2 relative z-1 ".concat(s," ").concat(e===x.J.CLIPPED||e===x.J.APPLIED||a&&e===x.J.UNCLIPPED?"":i?"product-border":"b--navy ba","\n    ").concat(t?"":"dib","\n    ").concat(a?"bg-near-white-blue":i?"product-background":"bg-washed-blue"));var k=t(363559),p=t(360991),b=t(344629),j=t(917516),y=t(974942);const S=e=>{let{baseClass:a,iconName:t,iconSize:i,iconClass:r,textClass:l,textMessage:n}=e;return(0,s.jsxs)("div",{className:a,children:[t&&(0,s.jsx)(y.J,{name:t,size:i,className:r,"aria-hidden":!0}),(0,s.jsx)("span",{className:l,children:n})]})};var L=t(191041);const N=e=>{let{baseClass:a,src:t,alt:i,width:r,height:l,preload:n,fetchPriority:o,imageClass:d,textClass:c,textMessage:m}=e;return(0,s.jsxs)("div",{className:a,children:[(0,s.jsx)(L.Z,{src:t,alt:i,width:r,height:l,preload:n,fetchPriority:o,className:d}),(0,s.jsx)("span",{className:c,children:m})]})},R=e=>{let{conditionalStr:a,ctaChildren:t,CTALinkExtras:i,eventMultiplierStr:r,fullWidth:l,href:o,item:d,restriction:c,restrictionTextStyle:m,rewardAppliedMessage:u,rewardAvailableMessage:h,rewardStateWithoutContext:v,showMultiLineRestriction:f,signIn:g,enableProductRewardStyleUpdate:k}=e;const{authState:{isLoggedIn:y}}=(0,p.Eu)(),L=(0,s.jsx)(b.Z,{href:o,variant:"tertiary",size:"medium",className:C()("f6 pa0 h-auto",l?"ml-auto":"ml5"),onLinkName:"signInToClaimWalmartReward",onLinkExtras:i,style:{whiteSpace:"inherit"},onClick:e=>{e.preventDefault(),null===g||void 0===g||g()},children:t});return(0,s.jsx)("div",{children:v===x.J.APPLIED?(0,s.jsx)(S,{baseClass:"flex items-center",iconName:"MoneyCircleFill",iconSize:"small",iconClass:"navy",textClass:"f7 navy b ml1 lh-solid",textMessage:u}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:C()("flex",{"flex-column items-start":!l}),children:[k?(0,s.jsx)(N,{baseClass:"flex items-center",src:j.OC,preload:!0,height:y?j.QA:j.X$,width:y?j.ob:j.Ke,alt:(0,n.m)(w,"cashLogo"),textClass:"f7 navy b ml1",textMessage:h}):(0,s.jsx)(S,{baseClass:"flex items-center",iconName:"MoneyCircleFill",iconSize:y?"small":"medium",iconClass:"navy",textClass:"f7 navy b ml1",textMessage:h}),!y&&l&&L]}),(0,s.jsx)("div",{className:C()("sans-serif f7 gray"),style:m||{marginLeft:30},id:"add-walmart-reward".concat(null===d||void 0===d?void 0:d.id),children:f?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{children:r}),(0,s.jsx)("div",{children:c})]}):a||""}),!y&&!l&&L]})})};var P=t(422613);const I=t.n(P)()((()=>t.e(4024).then(t.bind(t,31275))),{loadableGenerated:{webpack:()=>[31275]},ssr:!1}),M=e=>{let{setShowErrorModal:a,sorryTextMessage:t}=e;const i=()=>{a(!1)};return(0,s.jsx)(I,{actions:(0,s.jsx)("div",{className:"center",children:(0,s.jsx)(b.Z,{className:"mb2",onClick:i,variant:"primary",size:"medium",onLinkName:"errorModalOk",children:(0,n.m)(w,"ok")})}),isOpen:!0,onClose:i,size:"small",title:(0,n.m)(w,"rewards"),children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"b",children:t}),(0,n.m)(w,"tryAgain")]})})};var A=t(573893),E=t(285549),T=t(997603);const D=e=>{let{rewardStateWithoutContext:a,setRewardState:t,setRewardStateWithoutContext:i,rewardAmt:r,savedRewardsMessage:l,offer:o,secondaryText:d,onToggleCheckbox:c,onClipRewardClick:m,preventDefaultClipHandler:u,clipRewardPromotion:h,item:f,onLinkExtras:g,isDisabled:k,showDetails:p,onClickDetails:j,showMultiLineRestriction:L,eventMultiplierStr:N,restriction:R,offerId:P,selectionToken:I,usItemId:M,secondaryPrefix:D,detailsButtonADAText:W,checkBoxADAText:J,restrictionTextStyle:z,conditionalStr:U,checkboxCustomClassName:B}=e;const{0:O,1:Z}=(0,v.useState)(!1),F={...g,li:{ath:{athAssest:(0,A.OI)(null===f||void 0===f?void 0:f.canonicalUrl)}}},_=()=>{(0,E.c)("digitalRewardsClick",Date.now().toString()),t&&t(x.J.CLIPPED),Z(!0),i(x.J.CLIPPED),g&&g.pr&&(g.pr.wd="1"),m&&m(f),u||h({input:{cbOffer:"".concat(P),selectionToken:I,usItemId:M||(null===f||void 0===f?void 0:f.usItemId)}}),c&&c()},K=a===x.J.CLIPPED,H=o&&!K&&!p&&!k;return(0,s.jsxs)("div",{className:C()({pointer:H}),...H&&{onClick:_},children:[(0,s.jsxs)("div",{className:"flex items-center",...K&&O&&{role:"alert"},children:[K?(0,s.jsx)(S,{iconName:"Check",iconSize:"medium",textClass:"f7 navy b ml1",textMessage:r?"$".concat(r.toFixed(2)," ").concat(l):l}):o&&(0,s.jsx)(T.Z,{label:o,onChange:p?_:()=>{},onLinkName:"addWalmartReward",onLinkExtras:f?F:g,"aria-label":J||"".concat(o," ").concat((0,n.m)(w,"walmartPlus"),", ").concat(d),className:B||"f7 navy b lh-title",disabled:k,checkboxProps:{"aria-describedby":"add-walmart-reward".concat(null===f||void 0===f?void 0:f.id)}}),p&&!k&&(0,s.jsx)(b.Z,{onClick:j,onLinkName:"showRewardDetails","aria-label":W||(0,n.m)(w,"showRewardDetails"),variant:"tertiary",size:"small",className:"bn pa0 no-underline ml2 h-inherit flex",disabled:k,children:(0,s.jsx)(y.J,{name:"InfoCircle",size:"small","aria-hidden":!0})})]}),(0,s.jsx)("div",{className:C()("sans-serif f7",{"light-gray":k,gray:!k}),style:z||{marginLeft:30},id:"add-walmart-reward".concat((null===f||void 0===f?void 0:f.id)||P),children:L?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{children:N}),(0,s.jsx)("div",{children:R})]}):U||""}),d&&(0,s.jsxs)("div",{className:"flex items-center mt1 mb2",style:{marginLeft:30},children:[D&&(0,s.jsx)(D,{}),(0,s.jsx)("span",{className:C()("f7 b ml2",{"light-gray":k,blue:!k}),children:d})]})]})},W=e=>{let{conditionalStr:a,ctaChildren:t,CTALinkExtras:i,eventMultiplierStr:r,fullWidth:l,href:n,item:o,restriction:d,restrictionTextStyle:c,showMultiLineRestriction:m,signIn:u,unlockRewardIcon:h,unlockRewardMessage:x}=e;const v=(0,s.jsx)(b.Z,{href:n,variant:"tertiary",size:"medium",className:C()("f6 pa0 h-auto",l?"ml-auto":"ml5"),onLinkName:"signInToClaimWalmartReward",onLinkExtras:i,style:{whiteSpace:"inherit"},onClick:e=>{e.preventDefault(),null===u||void 0===u||u()},children:t});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:C()("flex",{"flex-column items-start":!l}),children:[(0,s.jsx)(S,{baseClass:"flex items-center",iconName:h,iconSize:"medium",iconClass:"navy",textClass:"f7 navy b ml1",textMessage:x}),l&&v]}),(0,s.jsx)("div",{className:C()("sans-serif f7 gray"),style:c||{marginLeft:30},id:"add-walmart-reward".concat(null===o||void 0===o?void 0:o.id),children:m?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{children:r}),(0,s.jsx)("div",{children:d})]}):a||""}),!l&&v]})},J=e=>{let{fullWidth:a,hideUnlockRewardIcon:t,unlockRewardIcon:i,unlockEarnRewardMessage:r,hideWalmartPlusBlueLogo:l,joinWPlusLinkExtras:o,joinWplus:d,ctaJoinWPlusChildren:c,secondaryText:m}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:C()("flex",{"flex-column items-start":!a}),children:[(0,s.jsxs)("div",{className:"flex items-center",children:[t?(0,s.jsx)(L.Z,{src:j.Xi,preload:!0,height:24,width:24,alt:(0,n.m)(w,"walmartPlus")}):i&&(0,s.jsx)(y.J,{name:i,size:"medium",className:"blue","aria-hidden":!0}),(0,s.jsx)("div",{className:"f7 navy b ml1",children:r}),!l&&a&&(0,s.jsx)(L.Z,{src:j.hE,alt:(0,n.m)(w,"walmartPlus"),preload:!1,width:54,height:18,"aria-hidden":!0,className:"ml1 mt1"})]}),(0,s.jsx)(b.Z,{variant:"tertiary",size:"medium",className:C()("f6 pa0 h-auto",a?"ml-auto":"ml5"),onLinkName:"joinWalmartPlus","aria-label":(0,n.m)(w,"joinWalmartPlus"),onLinkExtras:o,onClick:d,style:{whiteSpace:"inherit"},children:c})]}),m&&(0,s.jsx)("div",{className:"f7 blue b mt1 mb2 ml5",children:m})]})};var z=t(675980);const U=e=>{let{joinWplus:a,signIn:t,href:f,unlockRewardIcon:C="MoneyCircle",rewardAmt:p,unlockRewardMessage:b="".concat((0,n.m)(w,"unlockReward")),savedRewardsMessage:j="".concat((0,n.m)(w,"rewardAdded")),unlockEarnRewardMessage:y="".concat((0,n.m)(w,"earnReward",{rewardAmt:p})),rewardAppliedMessage:S=(0,n.m)(w,"rewardApplied"),rewardAvailableMessage:L=(0,n.m)(w,"rewardAvailable"),sorryTextMessage:N=(0,n.m)(w,"sorryText"),rewardSavedMessage:P=(0,n.m)(w,"rewardSaved"),hideWalmartPlusBlueLogo:I,detailsButtonADAText:A,hideUnlockRewardIcon:E,ctaChildren:T="".concat((0,n.m)(w,"signIn")),ctaJoinWPlusChildren:U="".concat((0,n.m)(w,"joinWalmartPlus")),item:B,offerId:O,selectionToken:Z,offer:F,state:_,restriction:K="",eventMultiplierStr:H="",enableCashBackRebrand:G=!1,moduleContext:V="",pageTitle:X="",onToggleCheckbox:Y=c.Z,showDetails:$,onClickDetails:q,onClipRewardClick:Q=c.Z,onClipRewardSuccess:ee=c.Z,onLinkExtras:ae={},usItemId:te,joinWPlusLinkExtras:se,fullWidth:ie=!1,secondaryText:re="",secondaryPrefix:le,isDisabled:ne,preventDefaultClipHandler:oe,showMultiLineRestriction:de,checkBoxADAText:ce="",restrictionTextStyle:me,CTALinkExtras:ue,className:he,checkboxCustomClassName:xe}=e;var ve,we;const fe=(0,l.iC)(i.YL),{wmcash:Ce}=(0,l.iC)(z.Y),ge=null===(ve=fe.shared.values)||void 0===ve?void 0:ve.enableProductRewardStyleUpdate,ke=null===Ce||void 0===Ce||null===(we=Ce.values)||void 0===we?void 0:we.enableClaimedOffersOLC,{addSnack:pe}=(0,r.useSnackbar)(),{router:be}=(0,d.tv)(),{rewardState:je,setRewardState:ye}=(0,k.Kf)(),{0:Se,1:Le}=(0,v.useState)(je||_);(0,v.useEffect)((()=>{Le(je||_)}),[je,_]);const{0:Ne,1:Re}=(0,v.useState)(!1),Pe=(0,o.wG)(),{clipRewardPromotion:Ie,error:Me,errors:Ae}=(e=>{const a=(0,m.G)(),[t,{data:s,isError:i}]=(0,u.D)((e=>a(h,e)),e);return{clipRewardPromotion:t,error:Boolean(null===s||void 0===s?void 0:s.errors)||i,errors:null===s||void 0===s?void 0:s.errors}})({onSuccess:(e,a)=>{e.errors||(ee(a),pe({message:ke?(0,n.m)(w,"rewardItemSavedMessage2"):P,actionButtonProps:{children:(0,n.m)(w,ke?"viewAll":"viewList"),onClick:()=>{be.push(ke?"/offer/claimed-offers":"/lists/RL/saved-rewards")}}}))}}),Ee=((e,a,t)=>{let s="",i="",r="",l="";return a?(i="".concat(t?"".concat((0,n.m)(w,"manufacturerOffer")," | "):(0,n.m)(w,"manufacturerOffer")),r="",l="".concat(t).slice("".concat(t).indexOf(" "))):(i="",r=e&&t?"".concat(e," - "):e,l="".concat(t?"".concat(t):"")),s=s.concat(i,r,l).trimStart(),s})(H,G,K);if((0,v.useEffect)((()=>{var e,a,t,s,i,r,l,n;Me&&(Pe({context:V,name:"error",action:"error",payload:{er:{rn:Ae&&(null===(e=Ae[0])||void 0===e||null===(a=e.extensions)||void 0===a?void 0:a.code),ms:Ae&&(null===(t=Ae[0])||void 0===t?void 0:t.message),dt:Ae&&(null===(s=Ae[0])||void 0===s||null===(i=s.extensions)||void 0===i||null===(r=i.exception)||void 0===r?void 0:r.message),ec:Ae&&(null===(l=Ae[0])||void 0===l||null===(n=l.extensions)||void 0===n?void 0:n.status)},ta:{pt:X}}}),Re(!0))}),[Me,Pe,Ae,V,X]),Se===x.J.UNKNOWN)return null;const Te=B?B.usItemId:"NullUsItemId";return(0,s.jsxs)(s.Fragment,{children:[!Me&&(0,s.jsx)("div",{className:"mt2 mb2",children:(0,s.jsxs)("div",{"data-testid":"qa-id-walmartReward-".concat(Te),className:g(Se,ne,ie,he,ge),children:[(Se===x.J.UNCLIPPED||Se===x.J.CLIPPED)&&(0,s.jsx)(D,{rewardStateWithoutContext:Se,setRewardState:ye,setRewardStateWithoutContext:Le,rewardAmt:p,savedRewardsMessage:j,offer:F,secondaryText:re,onToggleCheckbox:Y,onClipRewardClick:Q,preventDefaultClipHandler:oe,clipRewardPromotion:Ie,item:B,onLinkExtras:ae,isDisabled:ne,showDetails:$,onClickDetails:q,showMultiLineRestriction:de,eventMultiplierStr:H,restriction:K,offerId:O,selectionToken:Z,usItemId:te,secondaryPrefix:le,detailsButtonADAText:A,checkBoxADAText:ce,restrictionTextStyle:me,conditionalStr:Ee,checkboxCustomClassName:xe}),(Se===x.J.APPLIED||Se===x.J.AVAILABLE)&&(0,s.jsx)(R,{rewardStateWithoutContext:Se,rewardAppliedMessage:S,rewardAvailableMessage:L,href:f,signIn:t,ctaChildren:T,CTALinkExtras:ue,restriction:K,restrictionTextStyle:me,item:B,showMultiLineRestriction:de,eventMultiplierStr:H,conditionalStr:Ee,fullWidth:ie,enableProductRewardStyleUpdate:ge}),Se===x.J.UNLOCK&&(0,s.jsx)(W,{fullWidth:ie,unlockRewardIcon:C,unlockRewardMessage:b,href:f,signIn:t,ctaChildren:T,CTALinkExtras:ue,restriction:K,restrictionTextStyle:me,item:B,showMultiLineRestriction:de,eventMultiplierStr:H,conditionalStr:Ee}),Se===x.J.UNLOCK_WITH_W_PLUS&&(0,s.jsx)(J,{fullWidth:ie,hideUnlockRewardIcon:E,unlockRewardIcon:C,unlockEarnRewardMessage:y,hideWalmartPlusBlueLogo:I,joinWPlusLinkExtras:se,joinWplus:a,ctaJoinWPlusChildren:U,secondaryText:re})]})}),Ne&&(0,s.jsx)(M,{setShowErrorModal:Re,sorryTextMessage:N})]})}}}]);