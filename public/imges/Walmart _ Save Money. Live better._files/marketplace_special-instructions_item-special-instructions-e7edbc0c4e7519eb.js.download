"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2709],{895258:function(e,n,a){a.d(n,{Y:function(){return U}});var l={};a.r(l),a.d(l,{Add:function(){return E},AddInstructions:function(){return h},Edit:function(){return L},EditInstructions:function(){return C},Save:function(){return F},ghostText:function(){return S},instructionLabel:function(){return P},modalContent:function(){return I},specialRequestLabel:function(){return v}});var t=a(247687),i=a(840210),r=a(442813),o=a(273060),s=a(190294),d=a(130903),u=a(517248),c=a(820491),m=a(851923);const p={type:"mutation",name:"updateItemInstructions",hash:"c02c46fcb6ff76a5e54e1d77b05bbc4907e32a91666834de20490f5a3b11a611"};var x=a(176020),b=a(315631),y=a(69284);var g=a(553776),w=a(285216),f=a(412193),A=a(969538);const v=()=>"Include a special request",S=()=>"Please write 'Happy birthday Mom!\" with a heart next to it",E=()=>"Add",L=()=>"Edit",h=()=>"Add instructions",C=()=>"Edit instructions",F=()=>"Save",I=()=>"Add a custom message or special request for the store. The store will do its best to accommodate you.",P=()=>"Your message or request";var M=a(541051),V=a(344629),T=a(974942),j=a(324523),R=a.n(j),O=a(573893),_=a(370771);const k=e=>{let{message:n="",onAddEditAction:a,actionStyleFlag:i=!0,analyticsContext:r="productPage",mpdModuleLinkExtras:o,isBYOD:s}=e;const{isMobile:d}=(0,M.vP)(),u=(0,_.WCA)(),c=(0,_.e0r)(),m=(0,_.S77)(),p=""===n?"Add":"Edit",x=s?"deliveryFromLocalStoreBYOD":"deliveryFromLocalStore",b="shoppingCart"===r?{co:{ty:x,id:x,nm:x}}:"productPage"===r?{li:{aa:{byod:s?1:0,seid:u,id:m,us:c}}}:{};return(0,t.jsx)(O.ZP,{name:"specialRequest",moduleContext:r,moduleLinkExtras:o,children:(0,t.jsxs)("div",{className:R()("f6 flex flex-row w-100 items-center pv3 mb3",{ph3:d&&i}),children:[(0,t.jsxs)("div",{className:R()("flex flex-column",{"w-90":!i}),children:[(0,t.jsxs)("div",{className:R()("flex w-100 b",{mt2:!d}),children:[(0,t.jsx)(T.J,{className:"mr2 mt1 ml0",name:"Note","aria-hidden":"true"})," ",(0,f.m)(l,"specialRequestLabel")]}),""!==n&&(0,t.jsx)("div",{className:"ml4 f6","data-testid":"special-request-message",children:n})]}),(0,t.jsx)(V.Z,{variant:"tertiary",className:R()("f6 mb0 lh-title dark-gray f6 ml3 mt1 f5-l pa0",{mt4:""!==n,"ml-auto":!i}),onClick:a,"aria-label":(0,f.m)(l,"".concat(p,"Instructions")),onLinkName:"".concat(p.toLocaleLowerCase(),"SpecialRequestClick"),"data-testid":"".concat(p,"-special-request"),onLinkExtras:b,children:(0,f.m)(l,p)})]})})};var z=a(431194),D=a(948668),q=a(659873),G=a(647312),N=a(385799),W=a(947975);const B=e=>{let{isOpen:n,isLoading:a,isError:i,errorMessage:r,onClose:o,onSave:s,title:d,instructionsMessage:u,instructionsLength:c=100,setInstructions:m,analyticsContext:p="productPage"}=e;const{isMobile:x}=(0,M.vP)(),{0:b,1:y}=(0,A.useState)(u),g={co:{tx:b,ov:"specialRequest"}};(0,A.useEffect)(()=>{y(u)},[u,n]);return(0,t.jsx)(O.ZP,{name:"specialRequest",moduleContext:p,children:(0,t.jsx)(G.Z,{title:d,isOpen:n,onClose:o,size:"medium",onLinkName:"close",onLinkExtras:{co:{ov:"specialRequest",tx:b}},onLinkExtrasForClose:{co:{ov:"specialRequest"},li:{tx:b}},children:(0,t.jsx)(D.tp,{context:p,action:"overlayView",name:"specialRequest",payload:g,children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:R()({"mt2 mb7":x}),children:[i&&(0,t.jsx)("div",{className:"mb3",children:(0,t.jsx)(q.Z,{variant:"error",role:"alert",children:r||z.lQ})}),(0,t.jsxs)("div",{className:"flex-column",children:[(0,t.jsx)("div",{className:"f5 lh-copy mb3 dark-gray",children:(0,f.m)(l,"modalContent")}),(0,t.jsx)(W.Z,{label:"".concat((0,f.m)(l,"instructionLabel")),onChange:e=>y(e.target.value),maxLength:c,size:"large",placeholder:(0,f.m)(l,"ghostText"),value:b})]})]}),(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)(V.Z,{variant:"primary",className:"h4 f5 w-100 mt3",size:"medium",onClick:()=>{m(b),s(b)},"aria-label":(0,f.m)(l,"Save"),onLinkName:"saveClick","data-testid":"save-special-request",onLinkExtras:{co:{ov:"specialRequest"},li:{tx:b}},children:a?(0,t.jsx)(N.$,{color:"white",size:"small"}):(0,f.m)(l,"Save")})})]})})})})},U=e=>{let{moduleConfigsData:n,lineItem:a,handleOnSaveWithoutUpdate:v,actionStyleFlag:S,analyticsContext:E="productPage",offerId:L,mpdModuleLinkExtras:h,isBYOD:C}=e;const{setSpecialInstructionsText:F}=(0,w.N)(),I=(null===n||void 0===n?void 0:n.requestText)||(0,f.m)(l,"specialRequestLabel"),P=(null===n||void 0===n?void 0:n.messageLength)?parseInt(null===n||void 0===n?void 0:n.messageLength,10):100,{0:M,1:V}=(0,A.useState)(""),{0:T,1:j}=(0,A.useState)(!1),{0:R,1:O}=(0,A.useState)(!1),_=(0,i.wh)(),z=null!==a&&void 0!==a?a:_.find(e=>e.product.offerId===L),{personalizedItemDetails:D}=null!==z&&void 0!==z?z:{},q=null===D||void 0===D?void 0:D.editableInstructionAttributes,G=(0,i.cF)(),N=(0,o.iC)(r.Tg,m.YL),{enableVisionItems:W,enableFulfillmentMajorAppliances:U,enableBYOD:Y}=N.cart.values,{enablePetRxManualRefill:H,enableItemLevelCheckout:X}=N.shared.values,[Z,{isLoading:Q}]=(()=>{const e=(0,o.iC)(r.Tg,m.YL),{enableAEBadge:n,enableQueueing:a,enablePartialSwitchModuleLevel:l,enableACCScheduling:t,enableCartBookslotShortcut:i,enableWplusCashback:g,enableBenefitSavings:w,enablePickupNotAvailable:f,enableReturnsLabel:A,enableStarRatings:v,enableClipRewards:S,enableI18n:E,enableWplusPetBenefit:L,enableGenericWalmartCash:h,enableOrderCutOffTimeInline:C,enableHotCartFeature:F,enableDroneDelivery:I,enableSuggestedSlotAvailability:P,enablePFS:M,enableACCVariant:V,enablePromoDiscount:T,enableFulfillmentChoice:j,enableAvailableFinancingOptions:R,enableFreeDeliveryThreshold:O,enableShippingOptions:_,enableShippingFeeClarity:k,enableAccQuantityNudge:z,enableFeeThresholdBar:D,enableSignatureOnDelivery:q,enableColdChainExpansion:G,enableMaximumThreshold:N,enableLatLonForAddress:W,enableUnscheduledPickup:B,enableItemDeliveryPrice:U,enableStreamlinedBadges:Y,enableRemoveAvailabilityStatus:H,enableFIGCartFulfillmentOption:X,enableExpressReservationEndTime:Z,enablePriceDetailsSavings:Q,enableAccFourTiresNudge:J,enableItemTypeAttributes:$,enablePromotionalMetaData:K,enableEligibleCareplans:ee,enableShowACCSchedulingInCart:ne,enableAOSLineItemId:ae,enableStaticMessageType:le,enableAOSPriceChangeExp:te,enablePayForSpeed:ie,enableFlowerDelivery:re}=e.cart.values,{enableExpressSla:oe,enableWeeklyReservationCartBookslot:se,enableBadges:de,enableWalmartPlusFreeDiscountedExpress:ue,enableHolidayFreeExpressDelivery:ce,enableMsiMci:me,enableSpendLimit:pe,enableTaxBreakdown:xe,enablePetRxManualRefill:be,enableItemLevelCheckout:ye,enableDigitalRewards:ge,enableSubscriptionsInTransaction:we,enableMCSEOptimization:fe,enableSubscribeToSaveNudge:Ae,enableSubscriptionDiscounts:ve,enableWplusACCPayForServiceOnline:Se,enableExpandedGiftingEligibility:Ee,enableMOQ:Le,enableWFSGlobal:he,enableMaxItemAllowedForRegularSlot:Ce,enableWic:Fe,enableGEP:Ie,enableWplusPhoneRecyclingPrevention:Pe,enableWplusBuyNowPhoneRecyclingPrevention:Me,enableRxpd:Ve,enableSellerFeeBreakdown:Te,enable3pEGiftCardPersonalization:je,enableAppleCareFreeTrials:Re,enablePaymentMethodPromotion:Oe,enableAOSRearchitect:_e,enableAOSModuleAttribute:ke,enableShowSavingsGrandTotal:ze,enableCCAFlow:De,enableTireInstallationWithFitment:qe,enableDestinationTax:Ge,enableSubscriptionsInTransactionDiscount:Ne,enableEachWeightItem:We}=e.shared.values,Be=(0,b.i)(),{onCartUpdate:Ue}=(0,y.er)(),Ye=(0,d.Zq)(),He=(0,u.Z)().getGqlFetch("cecxo");return(0,c.D)(e=>He(p,{...e,input:{...e.input},includePartialFulfillmentSwitching:l,enableAEBadge:n,enableBadges:de,includeExpressSla:oe,includeQueueing:a,enableWeeklyReservationCartBookslot:se,enableCartBookslotShortcut:i,enableACCScheduling:t,enableWalmartPlusFreeDiscountedExpress:ue,enableDiscountedOrHolidayExpress:ue||ce,enableBenefitSavings:w,enableUnifiedBadges:Be,enablePickupNotAvailable:f,enableReturnsLabel:A,enableStarRatings:v,enableSpendLimit:pe,enableMsiMci:me,enableClipRewards:S,enableTaxBreakdown:xe,enableI18nWave1:(0,x.Xd)(E),enableWplusPetBenefit:L,enableCartLevelPromotions:g||L||h||ge,enableOrderCutOffTime:C||q,enableHotCartFeature:F,enableRxpd:Ve,enableDroneDelivery:I,enableMOQ:Le,enablePetRxManualRefill:be,enableItemLevelCheckout:ye,enableSuggestedSlotAvailability:P,enablePFS:M&&1===V,enableSubscriptionsInTransaction:we,enableSubscribeToSaveNudge:Ae,enableSubscriptionDiscounts:ve,enablePromoDiscount:T,enableWplusACCPayForServiceOnline:Se,includeItemPackaging:Ee,enableWFSGlobal:he,includeFulfillmentSwitchOptions:j,enableMaxItemAllowedForRegularSlot:Ce,enableAvailableFinancingOptions:R,enableFreeDeliveryThreshold:O,enableShippingOptions:_,enableShippingFeeClarity:k,getPriceInfoDetails:k||z||Ve,enableAccQuantityNudge:z||J,enableFeeThresholdBar:D,enableWic:Fe,enableColdChainExpansion:G,enableGEP:Ie,enableIsEligibleForFreeTrialV1:Pe||Me,enableMaximumThreshold:N,enableSellerFeeBreakdown:Te,enable3pEGiftCardPersonalization:je,enableAppleCareFreeTrials:Re,enableAOSRearchitect:_e,enableAOSModuleAttribute:ke,enableLatLonForAddress:W,enablePaymentMethodPromotion:Oe,enableUnscheduledPickup:B,enableUnscheduledShippingOptions:B&&_,enableItemDeliveryPrice:U,enableShowSavingsGrandTotal:ze,enableCCAFlow:De,enableStreamlinedBadges:Y,enableRemoveAvailabilityStatus:H,enableFIGCartFulfillmentOption:X,enableExpressReservationEndTime:Z,subscriptionInTransactionAndDetailed:!fe&&we,enablePriceDetailsSavings:Q,enableItemTypeAttributes:$,includeFitment:qe,enablePromotionalMetaData:K,enableEligibleCareplans:ee,enableShowACCSchedulingInCart:ne,enableAOSLineItemId:ae,enableDestinationTax:Ge,enableSubscriptionsInTransactionDiscount:Ne,enableStaticMessageType:le,enableEachWeightItem:We,enableAOSPriceChangeExp:te,enablePayForSpeed:ie,enableFlowerDelivery:re}),{onError:(e,n)=>{(0,s.cM)(["error","cart","update_item_instructions_from_cart","update item instructions mutation failure"],{type:"log",message:e})},onSuccess:(e,n)=>{var a;if(null===e||void 0===e||null===(a=e.errors)||void 0===a?void 0:a.length){var l;(0,s.cM)(["error","cart","update_item_instructions_error"],{type:"log",errors:e.errors,variables:n,correlationId:null===(l=e.headers)||void 0===l?void 0:l.get("x-o-correlation-id")})}else{var t;const n=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.updateItemInstructions,a={data:{cart:n}};Ye.setQueryData(["cart-index-get-cart",{id:null===n||void 0===n?void 0:n.id}],a),Ue(n)}}})})();(0,A.useEffect)(()=>{var e;(null===q||void 0===q?void 0:q.length)&&V((null===(e=null===q||void 0===q?void 0:q.filter(e=>"SPECIAL_INSTRUCTIONS"===(null===e||void 0===e?void 0:e.type))[0])||void 0===e?void 0:e.value)||"")},[q]);const J=()=>{j(!1)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k,{message:M,onAddEditAction:()=>{j(!0)},actionStyleFlag:S,analyticsContext:E,mpdModuleLinkExtras:h,isBYOD:C}),(0,t.jsx)(B,{isOpen:T,isLoading:Q,onClose:J,isError:R,onSave:async e=>{if(z&&(null===z||void 0===z?void 0:z.id)){var n;const a={cartId:G,items:[{lineItemId:null===z||void 0===z?void 0:z.id,itemInstructions:[{type:"SPECIAL_INSTRUCTIONS",value:e}]}],features:(0,g.N)({enableVisionItems:W,enablePetRxManualRefill:H,enableItemLevelCheckout:X,enableFulfillmentMajorAppliances:U,enableBYOD:Y})},l=await Z({input:a});(null===l||void 0===l||null===(n=l.data)||void 0===n?void 0:n.updateItemInstructions)&&!l.errors?(O(!1),J()):O(!0)}else F(e),null===v||void 0===v||v(e),J()},title:I,instructionsMessage:M,setInstructions:V,instructionsLength:P,analyticsContext:E})]})}}}]);